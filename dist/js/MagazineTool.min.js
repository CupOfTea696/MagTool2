var MagTool=MagTool||{};!function(a,b,c){c.modules={},c.$body=b("body"),c.edit=function(){var a=c.Page.getId();c.Server.edit(a).done(function(a){a.response.indexOf("is locked for editing")>-1?console.log("Locked the page; ready to edit"):console.log("Page is being edited")}).fail(function(){console.log("receiving errors")})},c.unlock=function(){var a=c.Page.getId();c.Server.unlock(a).done(function(){console.log("page unlocked")}).fail(function(){console.log("couldnt unlock")})},c.save=function(){c.ContentEditor.cleanUp();var a=c.Page.getId(),b=c.ContentEditor.getCreditsHtml(),d=c.ContentEditor.getContentHtml(),e=c.ContentEditor.getVideoHtml();console.info("Copy the following output into common/script.html:"),console.log(">>>> BEGIN SCRIPT.HTML CONTENT <<<<"),console.log(e),console.log("<<<< END SCRIPT.HTML CONTENT >>>>"),c.Server.save(a,b,d).done(function(){console.log("Saved successfully")}).fail(function(){console.log("Save error")})}}(window,$,MagTool),function(a,b,c){function d(){var a,d=function(){return"undefined"!=typeof a&&a.length||(a=b("#html")),a},e=function(){d().html("")};this.cleanUp=function(){c.Page.get().find("[style]:not(.videoLoader):not(object)").removeAttr("style"),c.Page.get().find("[contenteditable], [aria-disabled], [data-mtifont], .ui-resizable, .onEdit").removeClass("onEdit ui-resizable").removeAttr("contenteditable aria-disabled data-mtifont")},this.getCreditsHtml=function(){return e(),c.Page.get().find('[class^="credits"]').clone().appendTo(d()),d().html()},this.getContentHtml=function(){return e(),c.Page.get().find('.magazineContent div:not([class^="credits"]):not(.edLetterList):not(.videoHolder)').clone().appendTo(a),a.html()},this.getVideoHtml=function(){return e(),c.Page.get().find(".videoHolder #videojs").clone().appendTo(a),a.html()}}c.modules.ContentEditor=d}(window,jQuery,MagTool),function(a,b,c){var d="http://magtool.local/",e="?v="+c.version,f="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css",g="css/app.css",h="tpl/magtool.html",i=function(a){var i;b.when(b.get(d+g+e).done(function(){b("<link>").attr({rel:"stylesheet",href:d+g+e}).appendTo(b("head"))}),b.get(f).done(function(){b("<link>").attr({rel:"stylesheet",href:f}).appendTo(b("head"))}),b.get(d+h+e).done(function(a){i=a})).done(function(){c.$body.append(i),a()})};c.Loader={load:i}}(window,$,MagTool),function(a,b,c,d){function e(){var a;this.get=function(){return"undefined"==typeof a&&(a=b("#page"+d.get_CurrentPageNumber())),a},this.getId=function(){return this.get().data("id")},this.getTitle=function(){return this.get().data("feature-title")},this.getIssueId=function(){return b("#magazineHolder").data("id")}}c.modules.Page=e}(window,jQuery,MagTool,magazineBuilder),function(a,b,c){function d(){var c="http://webprod-nap.dave.net-a-porter.com/save_test";this.edit=function(d){var e={req_type:"start_edit",page_id:d};return e=a.JSON.stringify(e),b.postJson(c,e)},this.unlock=function(d){var e={req_type:"unlock",page_id:d};return e=a.JSON.stringify(e),b.postJson(c,e)},this.save=function(d,e,f){var g={req_type:"save_changes",page_id:d,credit:e,content:f};return g=a.JSON.stringify(g),b.postJson(c,g)}}c.modules.Server=d}(window,jQuery,MagTool),function(a,b,c){c.Loader.load(function(){for(var a in c.modules)c[a]=new c.modules[a]}),b("body").on("click","[data-action]",function(){var a=b(this).data("action");c[a]()})}(window,jQuery,MagTool);
//# sourceMappingURL=MagazineTool.min.js.map