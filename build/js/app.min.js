var app=app||{};!function(e){e.modules={}}(app),function($){$.postJson=function(e,t){return $.ajax(e,{global:!1,type:"POST",cache:!1,contentType:"application/json",data:t})}}(jQuery),function(e,$,t){var n="http://magtool.local/",o="?v="+t.version,i="css/app.css",a="tpl/magtool.html",r=function(e){var r;$.when($.get(n+i+o).done(function(){$("<link>").attr({rel:"stylesheet",href:n+i+o}).appendTo($("head"))}),$.get(n+a+o).done(function(e){r=e})).then(function(){t.$body.append(r),e()})};t.Loader={load:r}}(window,$,app),function(e,$,t,n){function o(){var e;this.get=function(){return"undefined"==typeof e&&(e=$("#page"+n.get_CurrentPageNumber())),e},this.getId=function(){return this.get().data("id")},this.getTitle=function(){return this.get().data("feature-title")}}t.modules.Page=o}(window,jQuery,app,magazineBuilder),function(e,$,t){function n(){var e,n=function(){return"undefined"!=typeof e&&e.length||(e=$("#html")),e},o=function(){n().html("")};this.cleanUp=function(){t.Page.get().find("[style]:not(.videoLoader):not(object)").removeAttr("style"),t.Page.get().find("[contenteditable], [aria-disabled], [data-mtifont], .ui-resizable, .onEdit").removeClass("onEdit ui-resizable").removeAttr("contenteditable aria-disabled data-mtifont")},this.getCreditsHtml=function(){return o(),t.Page.get().find('[class^="credits"]').clone().appendTo(n()),n().html()},this.getContentHtml=function(){return o(),t.Page.get().find('.magazineContent div:not([class^="credits"]):not(.edLetterList):not(.videoHolder)').clone().appendTo(e),e.html()},this.getVideoHtml=function(){return o(),t.Page.get().find(".videoHolder #videojs").clone().appendTo(e),e.html()}}t.modules.ContentEditor=n}(window,jQuery,app),function(e,$,t){function n(){var t="http://webprod-nap.dave.net-a-porter.com/save_test";this.edit=function(n){var o={req_type:"start_edit",page_id:n};return o=e.JSON.stringify(o),$.postJson(t,o)},this.unlock=function(n){var o={req_type:"unlock",page_id:n};return o=e.JSON.stringify(o),$.postJson(t,o)},this.save=function(n,o,i){var a={req_type:"save_changes",page_id:n,credit:o,content:i};return a=e.JSON.stringify(a),$.postJson(t,a)}}t.modules.Server=n}(window,jQuery,app),function(e,$,t){t.$body=$("body"),t.Loader.load(function(){for(var e in t.modules)t[e]=new t.modules[e]}),t.edit=function(){var e=t.Page.getId();t.Server.edit(e).done(function(e){e.response.indexOf("is locked for editing")>-1?console.log("Locked the page; ready to edit"):console.log("Page is being edited")}).fail(function(){console.log("receiving errors")})},t.unlock=function(){var e=t.Page.getId();t.Server.unlock(e).done(function(){console.log("page unlocked")}).fail(function(){console.log("couldnt unlock")})},t.save=function(){t.ContentEditor.cleanUp();var e=t.Page.getId(),n=t.ContentEditor.getCreditsHtml(),o=t.ContentEditor.getContentHtml(),i=t.ContentEditor.getVideoHtml();console.info("Copy the following output into common/script.html:"),console.log(">>>> BEGIN SCRIPT.HTML CONTENT <<<<"),console.log(i),console.log("<<<< END SCRIPT.HTML CONTENT >>>>"),t.Server.save(e,n,o).done(function(){console.log("Saved successfully")}).fail(function(){console.log("Save error")})}}(window,$,app);
//# sourceMappingURL=./app.min.js.map