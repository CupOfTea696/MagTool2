var app=app||{};!function(e,$,t){var n="http://rawgit.com/NAPWebProductionEditTeam/MagTool2/master/",o="?v="+t.commit,a="build/css/app.css",i="build/tpl/magtool.html",d=function(e){var d;$.when($.get(n+a+o).done(function(){$("<link>").attr({rel:"stylesheet",href:n+a+o}).appendTo($("head"))}),$.get(n+i+o).done(function(e){d=e})).then(function(){t.$body.append(d),e()})};t.Loader={load:d}}(window,$,app),function(e,$,t,n){var o,a=function(){return"undefined"==typeof o&&(o=$("#page"+n.get_CurrentPageNumber())),o},i=function(){return a().data("id")},d=function(){return a().data("feature-title")};t.Page={get:a,getId:i,getTitle:d}}(window,jQuery,app,magazineBuilder),function(e,$,t){var n=$("#html"),o=function(){n.html("")},a=function(){t.Page.getPage().find("[style]:not(.videoLoader):not(object)").removeAttr("style"),t.Page.getPage().find("[contenteditable], [aria-disabled], [data-mtifont], .ui-resizable, .onEdit").removeClass("onEdit ui-resizable").removeAttr("contenteditable aria-disabled data-mtifont")},i=function(){return o(),t.Page.getPage().find('[class^="credits"]').clone().appendTo(n),n.html()},d=function(){return o(),t.Page.getPage().find('.magazineContent div:not([class^="credits"]):not(.edLetterList):not(.videoHolder)').clone().appendTo(n),n.html()},r=function(){return o(),t.Page.getPage().find(".videoHolder #videojs").clone().appendTo(n),n.html()};t.ContentEditor={getCreditsHtml:i,getContentHtml:d,getVideoHtml:r}}(window,jQuery,app),function(e,$,t){var n="http://webprod-nap.dave.net-a-porter.com/save_test",o=function(e,t,o){var a={req_type:"save_changes",page_id:e,credit:t,content:o};return $.post(n,a)};t.Server={save:o}}(window,jQuery,app),function(e,$,t){t.$body=$("body"),t.Loader.load(function(){}),t.save=function(){t.ContentEditor.cleanUp();var e=t.Page.getId(),n=t.ContentEditor.getCreditsHtml(),o=t.ContentEditor.getContentHtml(),a=t.ContentEditor.getVideoHtml();console.info("Copy the following output into common/script.html:"),console.log(">>>> BEGIN SCRIPT.HTML CONTENT <<<<"),console.log(a),console.log("<<<< END SCRIPT.HTML CONTENT >>>>"),t.Server.save(e,n,o).done(function(){console.log("Saved successfully")}).fail(function(){console.log("Save error")})}}(window,$,app);